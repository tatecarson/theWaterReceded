'use strict';
var oscMin = require('osc-min')
  , _ = require('underscore')

var _subscribed = false

exports.binary = function binary(size, fn) {
  var address, args, buf
  if (!_subscribed) {
    address = '/sys/subscribe'
    args = ['/']
    _subscribed = true
  } else {
    address = '/bla'//_randomAddress()
    args = [1, 2]
  }
  buf = oscMin.toBuffer({ address: address, args: args })//new Buffer(size)
  fn(undefined, buf)
}

var _randomAddress = function() {
  return '/' + _.range(_randomInt(5)).map(() => _randomString(5 + _randomInt(10))).join('/')
}

var _randomString = function(length) {
  var chars = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  return _.range(length).map(() => chars[_randomInt(chars.length)]).join('')
}

var _randomInt = function(maxNum) { 
  return Math.floor(Math.random() * maxNum)
}